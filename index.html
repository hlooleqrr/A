<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>حاسبة التمويل - سرعة تملك العقار</title>
  <style>
    body{font-family:'Tajawal',sans-serif;background:#f4f6f8;margin:0;text-align:center}
    header{background:#005c48;color:#fff;padding:20px}
    .container{max-width:600px;margin:20px auto;background:#fff;padding:20px;border-radius:10px;box-shadow:0 0 15px rgba(0,0,0,.1)}
    input,select,button{width:90%;padding:10px;margin:10px 0;font-size:16px;border-radius:5px;border:1px solid #ccc}
    button{background:#00796b;color:#fff;border:none;cursor:pointer}
    button:hover{background:#004d40}
    footer{font-size:12px;color:#666;margin-top:40px;padding:10px}
    .fade-in{opacity:0;transform:translateY(20px);animation:fadeInMove .6s forwards}
    @keyframes fadeInMove{to{opacity:1;transform:translateY(0)}}
  </style>
</head>
<body>
<header>
  <h1>سرعة تملك العقار والحلول التمويلية</h1>
  <p>حاسبة التمويل التقريبية</p>
</header>
<div class="container" id="form-container">
  <div id="question"></div>
  <button onclick="nextQuestion()">ابدأ الحسبة</button>
</div>
<script>
let answers = { commitments: [] }, step = 0, commitmentStep = 0, currentCommitment = {};
const generalQuestions = [
  { id:'financeType',label:'نوع التمويل',type:'select',options:['تمويل عقاري','تمويل شخصي'] },
  { id:'supported',label:'هل التمويل مدعوم؟',type:'select',options:['مدعوم','غير مدعوم'],show:a=>a.financeType==='تمويل عقاري' },
  { id:'bundle',label:'هل ترغب في دفعة مقدمة من سكني؟',type:'select',options:['نعم','لا'],show:a=>a.supported==='مدعوم' },
  { id:'salary',label:'كم الراتب الشهري؟',type:'number' },
  { id:'months',label:'عدد الأشهر للتمويل',type:'range',min:12,max:360,value:240 },
  { id:'profitMargin',label:'نسبة هامش الربح السنوي (%)؟',type:'number' },
  { id:'hasCommitments',label:'هل لديك التزامات؟',type:'select',options:['نعم','لا'] }
];
const commitmentQuestions = [
  { id:'type',label:'نوع الالتزام',type:'select',options:['قرض شخصي','قرض سيارة','قرض استهلاكي'] },
  { id:'amount',label:'كم القسط الشهري؟',type:'number' },
  { id:'months',label:'كم عدد الأشهر المتبقية؟',type:'select',options:Array.from({length:60},(_,i)=>(i+1)+' شهر') },
  { id:'more',label:'هل لديك التزامات أخرى؟',type:'select',options:['نعم','لا'] }
];
function showQuestion(){
  const container=document.getElementById('question'); container.innerHTML='';
  let q;
  if(step<generalQuestions.length){
    q=generalQuestions[step];
    if(q.show && !q.show(answers)){step++;showQuestion();return;}
  }else if(answers.hasCommitments==='نعم'){
    q=commitmentQuestions[commitmentStep];
  }else{calculate();document.querySelector('button').style.display='none';return;}
  const div=document.createElement('div');div.classList.add('fade-in');
  const label=document.createElement('label');label.textContent=q.label;div.appendChild(label);
  div.appendChild(document.createElement('br'));
  if(q.type==='select'){
    const sel=document.createElement('select');sel.id=q.id;
    q.options.forEach(opt=>{const o=document.createElement('option');o.value=o.textContent=opt;sel.appendChild(o);});
    div.appendChild(sel);
  }else if(q.type==='range'){
    const inp=document.createElement('input');inp.type='range';inp.id=q.id;
    inp.min=q.min;inp.max=q.max;inp.value=q.value;
    inp.oninput=()=>document.getElementById(q.id+'Val').innerText=inp.value;
    div.appendChild(inp);div.appendChild(document.createElement('br'));
    const span=document.createElement('span');span.id=q.id+'Val';span.textContent=q.value;
    div.appendChild(span);div.appendChild(document.createTextNode(' شهر'));
  }else{
    const inp=document.createElement('input');inp.type='number';inp.id=q.id;div.appendChild(inp);
  }
  container.appendChild(div);
}
function nextQuestion(){
  const q=step<generalQuestions.length?generalQuestions[step]:commitmentQuestions[commitmentStep];
  const val=document.getElementById(q.id)?.value;
  if(step<generalQuestions.length){
    answers[q.id]=val;step++;
  }else{
    if(q.id==='months