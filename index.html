<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Ø­Ø§Ø³Ø¨Ø© Ø§Ù„ØªÙ…ÙˆÙŠÙ„ â€“ Ø³Ø±Ø¹Ø© ØªÙ…Ù„Ùƒ Ø§Ù„Ø¹Ù‚Ø§Ø±</title>
  <style>
    body{font-family:'Tajawal',sans-serif;background:#f4f6f8;margin:0;text-align:center}
    header{background:#005c48;color:#fff;padding:20px}
    .container{max-width:600px;margin:20px auto;background:#fff;padding:20px;border-radius:10px;
      box-shadow:0 0 15px rgba(0,0,0,.1)}
    input,select,button{width:90%;padding:10px;margin:10px 0;font-size:16px;border-radius:5px;border:1px solid #ccc}
    button{background:#00796b;color:#fff;border:none;cursor:pointer}
    button:hover{background:#004d40}
    footer{font-size:12px;color:#666;margin-top:40px;padding:10px}
    .fade-in{opacity:0;transform:translateY(20px);animation:fadeIn .6s forwards}
    @keyframes fadeIn{to{opacity:1;transform:translateY(0)}}
  </style>
</head>
<body>

<header>
  <h1>Ø³Ø±Ø¹Ø© ØªÙ…Ù„Ùƒ Ø§Ù„Ø¹Ù‚Ø§Ø± ÙˆØ§Ù„Ø­Ù„ÙˆÙ„ Ø§Ù„ØªÙ…ÙˆÙŠÙ„ÙŠØ©</h1>
  <p>Ø­Ø§Ø³Ø¨Ø© Ø§Ù„ØªÙ…ÙˆÙŠÙ„ Ø§Ù„ØªÙ‚Ø±ÙŠØ¨ÙŠØ©</p>
</header>

<div class="container" id="form-container">
  <div id="question"></div>
  <button id="mainBtn" onclick="nextQuestion()">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø­Ø§Ø³Ø¨Ø©</button>
</div>

<script>
// Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª ÙˆØ§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø­Ø³Ø¨ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø¯Ù‚ÙŠÙ‚Ø© Ø§Ù„Ø®Ø§ØµØ© Ø¨Ùƒ
let answers = {commitments: []};
let step = 0, commitmentIndex = 0;
const months60  = [...Array(60 ).keys()].map(x=>x+1);
const months360 = [...Array(360).keys()].map(x=>x+1);

const baseQuestions = [
  {id:'financeType', label:'Ù†ÙˆØ¹ Ø§Ù„ØªÙ…ÙˆÙŠÙ„', type:'select', options:['ØªÙ…ÙˆÙŠÙ„ Ø¹Ù‚Ø§Ø±ÙŠ','ØªÙ…ÙˆÙŠÙ„ Ø´Ø®ØµÙŠ']},
  {id:'supported', label:'Ù‡Ù„ Ø§Ù„ØªÙ…ÙˆÙŠÙ„ Ù…Ø¯Ø¹ÙˆÙ…ØŸ', type:'select', options:['Ù…Ø¯Ø¹ÙˆÙ…','ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…'], show:a=>a.financeType==='ØªÙ…ÙˆÙŠÙ„ Ø¹Ù‚Ø§Ø±ÙŠ'},
  {id:'bundle', label:'Ù‡Ù„ ØªØ±ØºØ¨ ÙÙŠ Ø¯ÙØ¹Ø© Ù…Ù‚Ø¯Ù…Ø© Ù…Ù† Ø³ÙƒÙ†ÙŠØŸ', type:'select', options:['Ù†Ø¹Ù…','Ù„Ø§'], show:a=>a.supported==='Ù…Ø¯Ø¹ÙˆÙ…'},
  {id:'salary', label:'ÙƒÙ… Ø§Ù„Ø±Ø§ØªØ¨ Ø§Ù„Ø´Ù‡Ø±ÙŠØŸ', type:'number'},
  {id:'months', label:'Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø´Ù‡Ø± Ù„Ù„ØªÙ…ÙˆÙŠÙ„', type:'range', min:12, max:360, value:240},
  {id:'profitMargin', label:'Ù†Ø³Ø¨Ø© Ù‡Ø§Ù…Ø´ Ø§Ù„Ø±Ø¨Ø­ Ø§Ù„Ø³Ù†ÙˆÙŠ (%)ØŸ', type:'number'},
  {id:'hasCommitments', label:'Ù‡Ù„ Ù„Ø¯ÙŠÙƒ Ø§Ù„ØªØ²Ø§Ù…Ø§ØªØŸ',type:'select',options:['Ù†Ø¹Ù…','Ù„Ø§']}
];

function showQuestion(){
  const zone=document.getElementById('question');
  zone.innerHTML='';
  const q=getCurrentQuestion();
  if(!q){ calculate(); document.getElementById('mainBtn').textContent='Ø£Ø¹Ø¯ Ø§Ù„Ø­Ø³Ø¨Ø©'; return;}
  if(q.show && !q.show(answers)){step++;showQuestion();return;}
  const wrap=document.createElement('div');wrap.className='fade-in';
  wrap.innerHTML=`<label>${q.label}</label><br/>`;
  if(q.type==='select'){
    const sel=document.createElement('select');sel.id=q.id;
    q.options.forEach(o=>sel.add(new Option(o,o)));wrap.appendChild(sel);
  }else if(q.type==='range'){
    const input=document.createElement('input');
    input.type='range'; input.min=q.min; input.max=q.max; input.value=q.value;
    input.step = 1; input.id=q.id;
    input.oninput=()=>val.textContent=input.value;
    const val=document.createElement('span');val.id=q.id+'Val';val.textContent=q.value;
    wrap.append(input,' ',val,' Ø´Ù‡Ø±');
  }else{
    const inp=document.createElement('input');inp.type='number';inp.id=q.id;wrap.appendChild(inp);
  }
  zone.appendChild(wrap);
}

function getCurrentQuestion(){
  if(step<baseQuestions.length) return baseQuestions[step];
  if(answers.hasCommitments==='Ù†Ø¹Ù…'){
    const c=answers.commitments[commitmentIndex]||{};
    if(!c.type)   return {id:'type',type:'select',label:'Ù†ÙˆØ¹ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…',options:['Ù‚Ø±Ø¶ Ø´Ø®ØµÙŠ','Ù‚Ø±Ø¶ Ø³ÙŠØ§Ø±Ø©','Ù‚Ø±Ø¶ Ø§Ø³ØªÙ‡Ù„Ø§ÙƒÙŠ']};
    if(!c.amount) return {id:'amount',type:'number',label:'ÙƒÙ… Ø§Ù„Ù‚Ø³Ø· Ø§Ù„Ø´Ù‡Ø±ÙŠØŸ'};
    if(!c.months) return {id:'monthsRemain',type:'select',label:'Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø´Ù‡Ø± Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©', options:months60.map(m=>m+' Ø´Ù‡Ø±')};
    if(c.type==='Ù‚Ø±Ø¶ Ø³ÙŠØ§Ø±Ø©' && c.askBalloon==null) return {id:'balloon',type:'select',label:'Ù‡Ù„ Ù„Ø¯ÙŠÙƒ Ø¯ÙØ¹Ø© Ø£Ø®ÙŠØ±Ø©ØŸ',options:['Ù†Ø¹Ù…','Ù„Ø§']};
    if(c.type==='Ù‚Ø±Ø¶ Ø³ÙŠØ§Ø±Ø©' && c.askBalloon==='Ù†Ø¹Ù…' && !c.balloonAmount) return {id:'balloonAmount',type:'number',label:'ÙƒÙ… Ù…Ø¨Ù„Øº Ø§Ù„Ø¯ÙØ¹Ø© Ø§Ù„Ø£Ø®ÙŠØ±Ø©ØŸ'};
    if(!c.askMore) return {id:'more',type:'select',label:'Ù‡Ù„ Ù„Ø¯ÙŠÙƒ Ø§Ù„ØªØ²Ø§Ù…Ø§Øª Ø£Ø®Ø±Ù‰ØŸ',options:['Ù†Ø¹Ù…','Ù„Ø§']};
  }
  return null;
}

function nextQuestion(){
  const q=getCurrentQuestion(); if(!q) return;
  const val=document.getElementById(q.id)?.value||null;
  if(step<baseQuestions.length){ answers[q.id]=val; step++; }
  else{
    let c=answers.commitments[commitmentIndex]||{};
    if(!c.type) c.type=val;
    else if(!c.amount) c.amount=parseFloat(val)||0;
    else if(!c.months) c.months=parseInt(val)||0;
    else if(c.type==='Ù‚Ø±Ø¶ Ø³ÙŠØ§Ø±Ø©' && c.askBalloon==null) c.askBalloon=val;
    else if(c.type==='Ù‚Ø±Ø¶ Ø³ÙŠØ§Ø±Ø©' && c.askBalloon==='Ù†Ø¹Ù…' && !c.balloonAmount) c.balloonAmount=parseFloat(val)||0;
    else if(!c.askMore){
      c.askMore=val;
      if(val==='Ù†Ø¹Ù…'){commitmentIndex++;answers.commitments.push({});}
    }
    answers.commitments[commitmentIndex]=c;
  }
  if(q.id==='financeType'){
    const monthsQ=baseQuestions.find(x=>x.id==='months');
    monthsQ.max = (val==='ØªÙ…ÙˆÙŠÙ„ Ø´Ø®ØµÙŠ')?60:360;
    monthsQ.value = (val==='ØªÙ…ÙˆÙŠÙ„ Ø´Ø®ØµÙŠ')?60:240;
    if(document.getElementById('months')) document.getElementById('months').max=monthsQ.max;
  }
  showQuestion();
}

// ğŸ§  Ø§Ù„Ø­Ø³Ø¨Ø© Ø¨ØªÙØµÙŠÙ„ ÙƒØ§Ù…Ù„ Ø³ØªØ±Ø³Ù„ ÙÙŠ Ø§Ù„Ø±Ø¯ Ø§Ù„Ù‚Ø§Ø¯Ù… Ø¨Ø³Ø¨Ø¨ Ø­Ø¬Ù… Ø§Ù„ÙƒÙˆØ¯
</script>

<footer>
  <p>Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø© â€“ Ø³Ø±Ø¹Ø© ØªÙ…Ù„Ùƒ Ø§Ù„Ø¹Ù‚Ø§Ø± ÙˆØ§Ù„Ø­Ù„ÙˆÙ„ Ø§Ù„ØªÙ…ÙˆÙŠÙ„ÙŠØ© â€“ <span id="datetime"></span></p>
</footer>
<script>
function updateDateTime(){
  const d=new Date(); document.getElementById('datetime').textContent =
    `${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,'0')}-${String(d.getDate()).padStart(2,'0')} ${String(d.getHours()).padStart(2,'0')}:${String(d.getMinutes()).padStart(2,'0')}:${String(d.getSeconds()).padStart(2,'0')}`;
}
setInterval(updateDateTime,1000); updateDateTime();
</script>

</body>
</html>