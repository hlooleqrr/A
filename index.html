<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Ø­Ø§Ø³Ø¨Ø© Ø§Ù„ØªÙ…ÙˆÙŠÙ„ â€“ Ø³Ø±Ø¹Ø© ØªÙ…Ù„Ùƒ Ø§Ù„Ø¹Ù‚Ø§Ø±</title>
<style>
  body{font-family:'Tajawal',sans-serif;background:#f4f6f8;margin:0;text-align:center}
  header{background:#005c48;color:#fff;padding:20px}
  .container{max-width:600px;margin:20px auto;background:#fff;padding:20px;border-radius:10px;
             box-shadow:0 0 15px rgba(0,0,0,.1)}
  input,select,button{width:90%;padding:10px;margin:10px 0;font-size:16px;border-radius:5px;border:1px solid #ccc}
  button{background:#00796b;color:#fff;border:none;cursor:pointer}
  button:hover{background:#004d40}
  footer{font-size:12px;color:#666;margin-top:40px;padding:10px}
  .fade{opacity:0;transform:translateY(20px);animation:fadeIn .5s forwards}@keyframes fadeIn{to{opacity:1;transform:none}}
</style>
</head>
<body>

<header>
  <h1>Ø³Ø±Ø¹Ø© ØªÙ…Ù„Ùƒ Ø§Ù„Ø¹Ù‚Ø§Ø±</h1>
  <p>Ø­Ø§Ø³Ø¨Ø© Ø§Ù„ØªÙ…ÙˆÙŠÙ„ (Ø¹Ù‚Ø§Ø±ÙŠ/Ø´Ø®ØµÙŠ)</p>
</header>

<div class="container" id="box">
  <div id="q"></div>
  <button onclick="next()">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø­Ø³Ø¨Ø©</button>
</div>

<script>
/* =========== Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª =========== */
let A={commitments:[]},step=0,cIndex=0;
const months60=[...Array(60 ).keys()].map(i=>i+1);
const months360=[...Array(360).keys()].map(i=>i+1);

/* =========== Ø§Ù„Ø£Ø³Ø¦Ù„Ø© =========== */
const Q=[
  {id:'type',label:'Ù†ÙˆØ¹ Ø§Ù„ØªÙ…ÙˆÙŠÙ„',type:'select',opt:['ØªÙ…ÙˆÙŠÙ„ Ø¹Ù‚Ø§Ø±ÙŠ','ØªÙ…ÙˆÙŠÙ„ Ø´Ø®ØµÙŠ']},
  {id:'supported',label:'Ù‡Ù„ Ø§Ù„ØªÙ…ÙˆÙŠÙ„ Ù…Ø¯Ø¹ÙˆÙ…ØŸ',type:'select',opt:['Ù…Ø¯Ø¹ÙˆÙ…','ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…'],show:a=>a.type==='ØªÙ…ÙˆÙŠÙ„ Ø¹Ù‚Ø§Ø±ÙŠ'},
  {id:'bundle',label:'Ù‡Ù„ ØªØ±ØºØ¨ ÙÙŠ Ø¯ÙØ¹Ø© Ù…Ù‚Ø¯Ù…Ø© Ù…Ù† Ø³ÙƒÙ†ÙŠØŸ',type:'select',opt:['Ù†Ø¹Ù…','Ù„Ø§'],show:a=>a.supported==='Ù…Ø¯Ø¹ÙˆÙ…'},
  {id:'salary',label:'ÙƒÙ… Ø§Ù„Ø±Ø§ØªØ¨ Ø§Ù„Ø´Ù‡Ø±ÙŠØŸ',type:'number'},
  {id:'months',label:'Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø´Ù‡Ø± Ù„Ù„ØªÙ…ÙˆÙŠÙ„',type:'range',min:1,max:360,value:240},
  {id:'profit',label:'Ù†Ø³Ø¨Ø© Ù‡Ø§Ù…Ø´ Ø§Ù„Ø±Ø¨Ø­ Ø§Ù„Ø³Ù†ÙˆÙŠ (%)',type:'number'},
  {id:'hasCom',label:'Ù‡Ù„ Ù„Ø¯ÙŠÙƒ Ø§Ù„ØªØ²Ø§Ù…Ø§ØªØŸ',type:'select',opt:['Ù†Ø¹Ù…','Ù„Ø§']}
];

/* =========== Ø¹Ø±Ø¶ Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠ =========== */
function show(){
  const zone=document.getElementById('q');
  zone.innerHTML='';
  const q=getCur();
  if(!q){calc();document.querySelector('button').style.display='none';return}
  if(q.show&&!q.show(A)){step++;show();return}

  const wrap=document.createElement('div');wrap.className='fade';
  wrap.innerHTML=`<label>${q.label}</label><br>`;
  if(q.type==='select'){
    const s=document.createElement('select');s.id=q.id;q.opt.forEach(o=>s.add(new Option(o,o)));wrap.appendChild(s);
  }else if(q.type==='range'){
    const r=document.createElement('input');r.type='range';r.min=q.min;r.max=q.max;r.value=q.value;r.id=q.id;
    r.oninput=()=>v.textContent=r.value;
    const v=document.createElement('span');v.id='v';v.textContent=r.value;wrap.append(r,' ',v,' Ø´Ù‡Ø±');
  }else{
    const n=document.createElement('input');n.type='number';n.id=q.id;wrap.appendChild(n);
  }
  zone.appendChild(wrap);
}

function getCur(){
  if(step<Q.length)return Q[step];
  if(A.hasCom==='Ù†Ø¹Ù…'){
    const c=A.commitments[cIndex]||{};
    if(!c.type)  return{id:'cType',type:'select',label:'Ù†ÙˆØ¹ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…',opt:['Ù‚Ø±Ø¶ Ø´Ø®ØµÙŠ','Ù‚Ø±Ø¶ Ø³ÙŠØ§Ø±Ø©','Ù‚Ø±Ø¶ Ø§Ø³ØªÙ‡Ù„Ø§ÙƒÙŠ']};
    if(!c.pay)   return{id:'cPay',type:'number',label:'ÙƒÙ… Ù‚ÙŠÙ…Ø© Ø§Ù„Ù‚Ø³Ø· Ø§Ù„Ø´Ù‡Ø±ÙŠØŸ'};
    if(!c.rem)   return{id:'cRem',type:'select',label:'Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø´Ù‡Ø± Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©',opt:months60.map(m=>m+' Ø´Ù‡Ø±')};
    if(c.type==='Ù‚Ø±Ø¶ Ø³ÙŠØ§Ø±Ø©'&&c.ball===undefined) return{id:'cBall',type:'number',label:'Ù…Ø¨Ù„Øº Ø§Ù„Ø¯ÙØ¹Ø© Ø§Ù„Ø£Ø®ÙŠØ±Ø© (Ø£Ùˆ 0)ØŸ'};
    if(!c.more)  return{id:'cMore',type:'select',label:'Ù‡Ù„ Ù„Ø¯ÙŠÙƒ Ø§Ù„ØªØ²Ø§Ù…Ø§Øª Ø£Ø®Ø±Ù‰ØŸ',opt:['Ù†Ø¹Ù…','Ù„Ø§']};
  }
  return null;
}

/* =========== Ø§Ù„ØªØ§Ù„ÙŠ =========== */
function next(){
  const q=getCur();if(!q)return;const val=document.getElementById(q.id)?.value||null;

  if(step<Q.length){A[q.id]=val;step++;}
  else{
    let c=A.commitments[cIndex]||{};
    if(!c.type)c.type=val;
    else if(!c.pay)c.pay=parseFloat(val)||0;
    else if(!c.rem)c.rem=parseInt(val)||0;
    else if(c.type==='Ù‚Ø±Ø¶ Ø³ÙŠØ§Ø±Ø©'&&c.ball===undefined)c.ball=parseFloat(val)||0;
    else if(!c.more){c.more=val;if(val==='Ù†Ø¹Ù…'){cIndex++;A.commitments.push({});}}
    A.commitments[cIndex]=c;
  }

  /* Ø¶Ø¨Ø· Ù…Ø¯Ù‰ Ø§Ù„Ø´Ù‡ÙˆØ± Ø­Ø³Ø¨ Ù†ÙˆØ¹ Ø§Ù„ØªÙ…ÙˆÙŠÙ„ */
  if(q.id==='type'){
    const m=Q.find(x=>x.id==='months');
    if(val==='ØªÙ…ÙˆÙŠÙ„ Ø´Ø®ØµÙŠ'){m.max=60;m.value=60;} else{m.max=360;m.value=240;}
  }
  show();
}

/* =========== Ø§Ù„Ø­Ø³Ø§Ø¨ =========== */
function calc(){
  const salary=+A.salary||0;
  const months=+A.months||0;
  const years=months/12;
  const pRate=+A.profit||0;

  /* Ø¨Ù†Ø§Ø¡ Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…Ø§Øª */
  let schedule=Array(months).fill(0),maxRem=0;
  if(A.hasCom==='Ù†Ø¹Ù…'){
    A.commitments.forEach(c=>{
      for(let i=0;i<c.rem&&i<months;i++)schedule[i]+=c.pay;
      maxRem=Math.max(maxRem,c.rem||0);
      if(c.type==='Ù‚Ø±Ø¶ Ø³ÙŠØ§Ø±Ø©'&&c.ball){
        const start=c.rem,end=Math.min(start+24,months);
        const add=c.ball/(end-start);
        for(let i=start;i<end;i++)schedule[i]+=add;
      }
    });
  }

  let payments=[];
  let admin,vat,commodity=0,extraSupport=0;
  let profitFactor,totalInst,netFinance,fees,finalNet,profitWO,profitW;

  if(A.type==='ØªÙ…ÙˆÙŠÙ„ Ø´Ø®ØµÙŠ'){ /* ---------- Ø´Ø®ØµÙŠ ---------- */
    const allowed=salary*0.45;
    const cap=salary*0.3333;
    for(let i=0;i<months;i++){
      const avail=Math.max(0,allowed-schedule[i]);
      payments[i]=Math.min(avail,cap);
    }
    totalInst=payments.reduce((a,b)=>a+b,0);
    profitFactor=years*pRate/100+1;
    netFinance=totalInst/profitFactor;
    admin=Math.min(netFinance*0.01,5000);
    vat=(admin===5000)?750:admin*0.15;
    commodity=netFinance*0.01;
    fees=admin+vat+commodity;
    finalNet=netFinance-fees;
  }else{              /* ---------- Ø¹Ù‚Ø§Ø±ÙŠ ---------- */
    const rate=salary<15000?0.55:0.65;
    const allowed=salary*rate;
    for(let i=0;i<months;i++){
      payments[i]=Math.max(0,allowed-schedule[i]);
    }
    totalInst=payments.reduce((a,b)=>a+b,0);
    profitFactor=years*pRate/100+1;
    netFinance=totalInst/profitFactor;
    admin=Math.min(netFinance*0.01,5000);
    vat=(admin===5000)?750:admin*0.15;
    fees=admin+vat; /* Ù„Ø§ Ø±Ø³ÙˆÙ… Ø³Ù„Ø¹ ÙÙŠ Ø§Ù„Ø¹Ù‚Ø§Ø±ÙŠ */
    finalNet=netFinance-fees;
    /* Ø¯Ø¹Ù… Ø³ÙƒÙ†ÙŠ */
    if(A.supported==='Ù…Ø¯Ø¹ÙˆÙ…'&&A.bundle==='Ù†Ø¹Ù…'){
      extraSupport=salary<10000?150000:100000;
    }
  }

  profitWO=totalInst-netFinance;
  profitW=profitWO+fees;

  const firstPay=payments[0].toFixed(0);
  const afterPay=(A.type==='ØªÙ…ÙˆÙŠÙ„ Ø´Ø®ØµÙŠ'?(salary*0.3333):(salary*(A.type==='ØªÙ…ÙˆÙŠÙ„ Ø¹Ù‚Ø§Ø±ÙŠ'&&(salary<15000?0.55:0.65)))).toFixed(0);

  document.getElementById('q').innerHTML=`
    <h2>Ù†ØªÙŠØ¬Ø© Ø§Ù„Ø­Ø§Ø³Ø¨Ø©:</h2>
    <p><strong>Ù‚Ø³Ø·Ùƒ Ø®Ù„Ø§Ù„ Ø£ÙˆÙ„ ${maxRem} Ø´Ù‡Ø± (Ù‚Ø³Ø·Ùƒ Ø§Ù„Ø¬Ø¯ÙŠØ¯):</strong> ${firstPay} Ø±ÙŠØ§Ù„</p>
    <p><strong>Ø«Ù… Ù‚Ø³Ø·Ùƒ Ø¨Ø¹Ø¯ Ø§Ù†ØªÙ‡Ø§Ø¡ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…Ø§Øª:</strong> ${afterPay} Ø±ÙŠØ§Ù„</p>
    <p><strong>Ø§Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØªÙ…ÙˆÙŠÙ„ Ù…Ø¹ Ø§Ù„Ø£Ø±Ø¨Ø§Ø­:</strong> ${totalInst.toFixed(0)} Ø±ÙŠØ§Ù„</p>
    <p><strong>Ù…Ø¹Ø§Ù…Ù„ Ø§Ù„Ø±Ø¨Ø­:</strong> ${profitFactor.toFixed(4)}</p>
    <p><strong>Ø§Ù„ØªÙ…ÙˆÙŠÙ„ Ø§Ù„ØµØ§ÙÙŠ Ù‚Ø¨Ù„ Ø§Ù„Ø±Ø³ÙˆÙ…:</strong> ${netFinance.toFixed(0)} Ø±ÙŠØ§Ù„</p>
    <p><strong>Ø§Ù„Ø±Ø³ÙˆÙ… Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠØ©:</strong> ${admin.toFixed(0)} Ø±ÙŠØ§Ù„</p>
    <p><strong>Ø§Ù„Ø¶Ø±ÙŠØ¨Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø±Ø³ÙˆÙ…:</strong> ${vat.toFixed(0)} Ø±ÙŠØ§Ù„</p>
    ${commodity?`<p><strong>Ø±Ø³ÙˆÙ… Ø§Ù„Ø³Ù„Ø¹:</strong> ${commodity.toFixed(0)} Ø±ÙŠØ§Ù„</p>`:''}
    <p><strong>Ø§Ù„Ø±Ø¨Ø­ Ø¯ÙˆÙ† Ø§Ù„Ø±Ø³ÙˆÙ…:</strong> ${profitWO.toFixed(0)} Ø±ÙŠØ§Ù„</p>
    <p><strong>Ø§Ù„Ø±Ø¨Ø­ Ù…Ø¹ Ø§Ù„Ø±Ø³ÙˆÙ…:</strong> ${profitW.toFixed(0)} Ø±ÙŠØ§Ù„</p>
    <p><strong>Ø§Ù„ØªÙ…ÙˆÙŠÙ„ Ø§Ù„ØµØ§ÙÙŠ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ:</strong> ${finalNet.toFixed(0)} Ø±ÙŠØ§Ù„</p>
    ${extraSupport?`<p><strong>Ø¯Ø¹Ù… Ø­ÙƒÙˆÙ…ÙŠ Ù…Ø¶Ø§Ù:</strong> ${extraSupport.toLocaleString()} Ø±ÙŠØ§Ù„</p>`:''}
    <h3 style="margin-top:20px;">ğŸ“ Ù„Ù„ØªÙˆØ§ØµÙ„: 0506214458 â€“ hlooleqrr.com</h3>
  `;
}

/* ØªØ´ØºÙŠÙ„ Ø£ÙˆÙ„ Ø³Ø¤Ø§Ù„ */
show();
</script>

<footer>
  <p>Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø© â€“ Ø³Ø±Ø¹Ø© ØªÙ…Ù„Ùƒ Ø§Ù„Ø¹Ù‚Ø§Ø± â€“ <span id="dt"></span></p>
</footer>
<script>
function tick(){const d=new Date();document.getElementById('dt').textContent=
`${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,'0')}-${String(d.getDate()).padStart(2,'0')} ${String(d.getHours()).padStart(2,'0')}:${String(d.getMinutes()).padStart(2,'0')}:${String(d.getSeconds()).padStart(2,'0')}`;}
setInterval(tick,1000);tick();
</script>

</body>
</html>