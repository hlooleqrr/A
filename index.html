<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>Ø³Ø±Ø¹Ø© ØªÙ…Ù„Ùƒ Ø§Ù„Ø¹Ù‚Ø§Ø± â€“ Ø­Ø§Ø³Ø¨Ø© Ø§Ù„ØªÙ…ÙˆÙŠÙ„</title>

  <!-- === ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„ØµÙØ­Ø© === -->
  <style>
    body{font-family:'Tajawal',sans-serif;background:#f4f6f8;margin:0;text-align:center}
    header{background:#005c48;color:#fff;padding:24px 10px}
    .container{max-width:600px;margin:20px auto;background:#fff;padding:20px;border-radius:10px;box-shadow:0 0 15px rgba(0,0,0,.1)}
    input,select,button{width:90%;padding:10px;margin:10px 0;font-size:16px;border-radius:5px;border:1px solid #ccc}
    button{background:#00796b;color:#fff;border:none;cursor:pointer}
    button:hover{background:#004d40}
    footer{font-size:12px;color:#666;margin-top:40px;padding:10px}
    .fade-in{opacity:0;transform:translateY(20px);animation:fadeIn .5s forwards}
    @keyframes fadeIn{to{opacity:1;transform:translateY(0)}}
  </style>
</head>
<body>

<!-- === Ø±Ø£Ø³ Ø§Ù„ØµÙØ­Ø© === -->
<header>
  <h1>Ø³Ø±Ø¹Ø© ØªÙ…Ù„Ùƒ Ø§Ù„Ø¹Ù‚Ø§Ø± ÙˆØ§Ù„Ø­Ù„ÙˆÙ„ Ø§Ù„ØªÙ…ÙˆÙŠÙ„ÙŠØ©</h1>
  <p>Ø­Ø§Ø³Ø¨Ø© Ø§Ù„ØªÙ…ÙˆÙŠÙ„ Ø§Ù„ØªÙ‚Ø±ÙŠØ¨ÙŠØ©</p>
</header>

<!-- === Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø£Ø³Ø¦Ù„Ø© === -->
<div class="container" id="form">
  <div id="question"></div>
  <button id="startBtn" onclick="nextQuestion()">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø­Ø³Ø¨Ø©</button>
</div>

<!-- === ØªØ°ÙŠÙŠÙ„ === -->
<footer>
  <p>Â© Ø³Ø±Ø¹Ø© ØªÙ…Ù„Ùƒ Ø§Ù„Ø¹Ù‚Ø§Ø± ÙˆØ§Ù„Ø­Ù„ÙˆÙ„ Ø§Ù„ØªÙ…ÙˆÙŠÙ„ÙŠØ© â€“ <span id="dt"></span></p>
</footer>

<!-- === ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªØ§Ø±ÙŠØ® === -->
<script>
function tick(){
  const d=new Date();
  document.getElementById('dt').textContent=
    d.toLocaleDateString('ar-SA',{year:'numeric',month:'2-digit',day:'2-digit'})+' '+
    d.toLocaleTimeString('ar-SA',{hour:'2-digit',minute:'2-digit',second:'2-digit'});
}
setInterval(tick,1000);tick();
</script>

<!-- === Ù…Ù†Ø·Ù‚ Ø§Ù„Ø­Ø§Ø³Ø¨Ø© Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ === -->
<script>
/* ---------------- Ù…ØªØºÙŠØ±Ø§Øª Ø±Ø¦ÙŠØ³ÙŠØ© ---------------- */
let answers={},commitments=[],curStep='start',curCommit={};

/* -------------- Ø¥Ø¸Ù‡Ø§Ø± Ø³Ø¤Ø§Ù„ Ø¹Ø§Ù… -------------- */
function show(html){
  const box=document.getElementById('question');
  box.innerHTML='<div class="fade-in">'+html+'</div>';
}

/* -------------- Ø§Ù„Ø§Ù†ØªÙ‚Ø§Ù„ Ù„Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„ØªØ§Ù„ÙŠ -------------- */
function nextQuestion(){
  if(curStep==='start'){ askFinanceType(); return; }

  // Ù„Ø§ Ø´ÙŠØ¡ Ø¥Ù† Ù„Ù… ÙŠÙƒÙ† Ù…Ø¹Ø±Ù
}

/* -------------- Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© -------------- */
function askFinanceType(){
  curStep='financeType';
  show(`
    <label>Ù†ÙˆØ¹ Ø§Ù„ØªÙ…ÙˆÙŠÙ„</label><br>
    <select id="financeType">
      <option value="ØªÙ…ÙˆÙŠÙ„ Ø¹Ù‚Ø§Ø±ÙŠ">ØªÙ…ÙˆÙŠÙ„ Ø¹Ù‚Ø§Ø±ÙŠ</option>
      <option value="ØªÙ…ÙˆÙŠÙ„ Ø´Ø®ØµÙŠ">ØªÙ…ÙˆÙŠÙ„ Ø´Ø®ØµÙŠ</option>
    </select><br>
    <button onclick="saveFinanceType()">Ø§Ù„ØªØ§Ù„ÙŠ</button>
  `);
}

function saveFinanceType(){
  answers.financeType=document.getElementById('financeType').value;
  (answers.financeType==='ØªÙ…ÙˆÙŠÙ„ Ø¹Ù‚Ø§Ø±ÙŠ')?askSupported():askSalary();
}

function askSupported(){
  curStep='supported';
  show(`
    <label>Ù‡Ù„ Ø§Ù„ØªÙ…ÙˆÙŠÙ„ Ù…Ø¯Ø¹ÙˆÙ…ØŸ</label><br>
    <select id="supported">
      <option value="Ù…Ø¯Ø¹ÙˆÙ…">Ù…Ø¯Ø¹ÙˆÙ…</option>
      <option value="ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…">ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ…</option>
    </select><br>
    <button onclick="saveSupported()">Ø§Ù„ØªØ§Ù„ÙŠ</button>
  `);
}
function saveSupported(){
  answers.supported=document.getElementById('supported').value;
  (answers.supported==='Ù…Ø¯Ø¹ÙˆÙ…')?askBundle():askSalary();
}

function askBundle(){
  curStep='bundle';
  show(`
    <label>Ù‡Ù„ ØªØ±ØºØ¨ Ø¨Ø¨Ø§Ù‚Ø© Ø³ÙƒÙ†ÙŠ Ø¯ÙØ¹Ø© Ù…Ù‚Ø¯Ù…Ø©ØŸ</label><br>
    <select id="bundle">
      <option value="Ù†Ø¹Ù…">Ù†Ø¹Ù…</option><option value="Ù„Ø§">Ù„Ø§</option>
    </select><br>
    <button onclick="saveBundle()">Ø§Ù„ØªØ§Ù„ÙŠ</button>
  `);
}
function saveBundle(){ answers.bundle=document.getElementById('bundle').value; askSalary(); }

function askSalary(){
  curStep='salary';
  show(`
    <label>Ø§Ù„Ø±Ø§ØªØ¨ Ø§Ù„Ø´Ù‡Ø±ÙŠ (Ø±ÙŠØ§Ù„)</label><br>
    <input type="number" id="salary"><br>
    <button onclick="saveSalary()">Ø§Ù„ØªØ§Ù„ÙŠ</button>
  `);
}
function saveSalary(){
  answers.salary=parseFloat(document.getElementById('salary').value)||0;
  askMonths();
}

function askMonths(){
  curStep='months';
  const max=answers.financeType==='ØªÙ…ÙˆÙŠÙ„ Ø¹Ù‚Ø§Ø±ÙŠ'?360:60;
  show(`
    <label>Ù…Ø¯Ø© Ø§Ù„ØªÙ…ÙˆÙŠÙ„ Ø¨Ø§Ù„Ø£Ø´Ù‡Ø±</label><br>
    <input type="range" id="months" min="12" max="${max}" value="12" oninput="document.getElementById('mVal').textContent=this.value">
    <br><span id="mVal">12</span> Ø´Ù‡Ø±<br>
    <button onclick="saveMonths()">Ø§Ù„ØªØ§Ù„ÙŠ</button>
  `);
}
function saveMonths(){ answers.months=parseInt(document.getElementById('months').value); askProfit(); }

function askProfit(){
  curStep='profit'; 
  show(`
    <label>Ù‡Ø§Ù…Ø´ Ø§Ù„Ø±Ø¨Ø­ Ø§Ù„Ø³Ù†ÙˆÙŠ (%)</label><br>
    <input type="number" id="profit"><br>
    <button onclick="saveProfit()">Ø§Ù„ØªØ§Ù„ÙŠ</button>
  `);
}
function saveProfit(){ answers.profit=parseFloat(document.getElementById('profit').value)||0; askHasCommit(); }

function askHasCommit(){
  curStep='hasCommit';
  show(`
    <label>Ù‡Ù„ Ù„Ø¯ÙŠÙƒ Ø§Ù„ØªØ²Ø§Ù…Ø§ØªØŸ</label><br>
    <select id="hasC"><option>Ù†Ø¹Ù…</option><option>Ù„Ø§</option></select><br>
    <button onclick="saveHasCommit()">Ø§Ù„ØªØ§Ù„ÙŠ</button>
  `);
}
function saveHasCommit(){
  answers.hasCommit=document.getElementById('hasC').value;
  (answers.hasCommit==='Ù†Ø¹Ù…')?askCommitType():calculate();
}

/* ------------ Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø§Ù„Ù…ØªÙƒØ±Ø± ------------ */
function askCommitType(){
  curStep='cType';
  show(`
    <label>Ù†ÙˆØ¹ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…</label><br>
    <select id="cType">
      <option>Ù‚Ø±Ø¶ Ø´Ø®ØµÙŠ</option>
      <option>Ù‚Ø±Ø¶ Ø³ÙŠØ§Ø±Ø©</option>
      <option>Ù‚Ø±Ø¶ Ø§Ø³ØªÙ‡Ù„Ø§ÙƒÙŠ</option>
    </select><br>
    <button onclick="saveCommitType()">Ø§Ù„ØªØ§Ù„ÙŠ</button>
  `);
}
function saveCommitType(){
  curCommit={type:document.getElementById('cType').value};
  askCommitPayment();
}
function askCommitPayment(){
  curStep='cPay';
  show(`
    <label>Ø§Ù„Ù‚Ø³Ø· Ø§Ù„Ø´Ù‡Ø±ÙŠ (Ø±ÙŠØ§Ù„)</label><br>
    <input type="number" id="cPay"><br>
    <button onclick="saveCommitPayment()">Ø§Ù„ØªØ§Ù„ÙŠ</button>
  `);
}
function saveCommitPayment(){ curCommit.pay=parseFloat(document.getElementById('cPay').value)||0; askCommitMonths(); }
function askCommitMonths(){
  curStep='cMonths';
  show(`
    <label>Ø§Ù„Ø£Ø´Ù‡Ø± Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©</label><br>
    <input type="range" id="cMonths" min="1" max="60" value="12" oninput="document.getElementById('mVal').textContent=this.value">
    <br><span id="mVal">12</span> Ø´Ù‡Ø±<br>
    <button onclick="saveCommitMonths()">Ø§Ù„ØªØ§Ù„ÙŠ</button>
  `);
}
function saveCommitMonths(){ curCommit.months=parseInt(document.getElementById('cMonths').value);
  (curCommit.type==='Ù‚Ø±Ø¶ Ø³ÙŠØ§Ø±Ø©')?askLastPayQ():finishCommit();
}
function askLastPayQ(){
  curStep='lastQ';
  show(`
    <label>Ù‡Ù„ ÙŠÙˆØ¬Ø¯ Ø¯ÙØ¹Ø© Ø£Ø®ÙŠØ±Ø©ØŸ</label><br>
    <select id="hasLast"><option>Ù†Ø¹Ù…</option><option>Ù„Ø§</option></select><br>
    <button onclick="saveLastQ()">Ø§Ù„ØªØ§Ù„ÙŠ</button>
  `);
}
function saveLastQ(){
  (document.getElementById('hasLast').value==='Ù†Ø¹Ù…')?askLastPay():curCommit.last=0,finishCommit();
}
function askLastPay(){
  curStep='lastPay';
  show(`
    <label>Ù…Ø¨Ù„Øº Ø§Ù„Ø¯ÙØ¹Ø© Ø§Ù„Ø£Ø®ÙŠØ±Ø© (Ø±ÙŠØ§Ù„)</label><br>
    <input type="number" id="last"><br>
    <button onclick="saveLastPay()">Ø§Ù„ØªØ§Ù„ÙŠ</button>
  `);
}
function saveLastPay(){ curCommit.last=parseFloat(document.getElementById('last').value)||0; finishCommit(); }

function finishCommit(){
  commitments.push(curCommit);
  askMore();
}
function askMore(){
  curStep='moreC';
  show(`
    <label>Ù‡Ù„ Ù„Ø¯ÙŠÙƒ Ø§Ù„ØªØ²Ø§Ù…Ø§Øª Ø£Ø®Ø±Ù‰ØŸ</label><br>
    <select id="more"><option>Ù†Ø¹Ù…</option><option>Ù„Ø§</option></select><br>
    <button onclick="saveMore()">Ø§Ù„ØªØ§Ù„ÙŠ</button>
  `);
}
function saveMore(){
  (document.getElementById('more').value==='Ù†Ø¹Ù…')?askCommitType():calculate();
}

/* ------------------- Ø§Ù„Ø­Ø³Ø¨Ø© ------------------- */
function calculate(){
  /* Ù…Ø¹Ø¯Ù„Ø§Øª Ø§Ù„Ø®ØµÙ… Ø­Ø³Ø¨ Ø§Ù„Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø£ØµÙ„ÙŠØ© */
  let rate= answers.financeType==='ØªÙ…ÙˆÙŠÙ„ Ø´Ø®ØµÙŠ'?33.33:(answers.salary<15000?55:65);
  let extra=0;
  if(answers.financeType==='ØªÙ…ÙˆÙŠÙ„ Ø¹Ù‚Ø§Ø±ÙŠ' && answers.supported==='Ù…Ø¯Ø¹ÙˆÙ…' && answers.bundle==='Ù†Ø¹Ù…'){
    extra=answers.salary<10000?150000:100000;
  }
  const allowed=answers.salary*rate/100;

  /* Ø®ØµÙ… Ø§Ù„Ø£Ù‚Ø³Ø§Ø· */
  let available=allowed;
  let maxMonths=0,totalInstWith=0;
  commitments.forEach(c=>{
    available-=c.pay;
    const total=c.pay*c.months+(c.last||0);
    totalInstWith+=total;
    if(c.months>maxMonths)maxMonths=c.months;
  });
  if(available<=0){
    show('<h3>Ù„Ø§ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ ØªÙ…ÙˆÙŠÙ„ Ø¨Ø³Ø¨Ø¨ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…Ø§Øª.</h3>');return;
  }

  const months=answers.months, monthsWithout=months-maxMonths;
  const totalWithout=allowed*monthsWithout;
  const grandTotal= totalInstWith + totalWithout;
  const profitFactor=(months/12)*answers.profit/100+1;
  const net=grandTotal/profitFactor;

  /* Ø§Ù„Ø±Ø³ÙˆÙ… */
  let admin=net*0.01; if(admin>5000)admin=5000;
  let vat=admin*0.15; if(vat>750)vat=750;
  const commodity= answers.financeType==='ØªÙ…ÙˆÙŠÙ„ Ø´Ø®ØµÙŠ'?net*0.01:0;
  const final=net-admin-vat-commodity+extra;

  show(`
    <h2>Ø§Ù„Ù†ØªÙŠØ¬Ø©:</h2>
    <p>Ù‚Ø³Ø· Ø£ÙˆÙ„ ${maxMonths} Ø´Ù‡Ø±: ${available.toFixed(0)} Ø±ÙŠØ§Ù„</p>
    <p>Ø«Ù… Ø§Ù„Ù‚Ø³Ø· Ø¨Ø¹Ø¯ Ø§Ù„Ø³Ø¯Ø§Ø¯: ${allowed.toFixed(0)} Ø±ÙŠØ§Ù„</p>
    <p>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØªÙ…ÙˆÙŠÙ„ Ø¨Ø§Ù„Ø£Ø±Ø¨Ø§Ø­: ${grandTotal.toFixed(0)} Ø±ÙŠØ§Ù„</p>
    <p>Ø§Ù„ØªÙ…ÙˆÙŠÙ„ Ø§Ù„ØµØ§ÙÙŠ Ù‚Ø¨Ù„ Ø§Ù„Ø±Ø³ÙˆÙ…: ${net.toFixed(0)} Ø±ÙŠØ§Ù„</p>
    <p>Ø§Ù„Ø±Ø³ÙˆÙ… Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠØ©: ${admin.toFixed(0)} Ø±ÙŠØ§Ù„</p>
    <p>Ø§Ù„Ø¶Ø±ÙŠØ¨Ø©: ${vat.toFixed(0)} Ø±ÙŠØ§Ù„</p>
    ${commodity?`<p>Ø±Ø³ÙˆÙ… Ø§Ù„Ø³Ù„Ø¹: ${commodity.toFixed(0)} Ø±ÙŠØ§Ù„</p>`:''}
    ${extra?`<p>Ø¯Ø¹Ù… Ø­ÙƒÙˆÙ…ÙŠ: ${extra.toLocaleString()} Ø±ÙŠØ§Ù„</p>`:''}
    <p><strong>Ø§Ù„ØªÙ…ÙˆÙŠÙ„ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ: ${final.toFixed(0)} Ø±ÙŠØ§Ù„</strong></p>
    <h3>ğŸ“ 0506214458 â€“ hlooleqrr.com</h3>
  `);
}

/* Ø¨Ø¯Ø¡ Ø§Ù„Ø¹Ù…Ù„ÙŠØ© */
nextQuestion();
</script>

</body>
</html>